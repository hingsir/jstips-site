<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>JsTips - Useful JavaScript Tips</title><meta name="keywords" content="jstips,tips,Useful JavaScript Tips"><meta name="description" content="Introduces these short and useful daily JavaScript tips that will allow you to improve your code writing. With less than 2 minutes each day, you will be able to read about performance, conventions, hacks, interview questions and all the items that the future of this awesome language holds for us"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scale=no"><link rel="icon" type="image/x-icon" href="../../images/favicon.ico"><link rel="stylesheet" type="text/css" href="../../css/all-7e45beae0a.min.css"><script type="text/javascript">window.onload = function(){
                document.getElementById('J_languages_select').onchange = function(){
                var lang = this.value;
                window.location.href = window.location.href.replace(/tips\/(\w+)\//,function($,$1){
                    return $.replace($1,lang);
                })
            }
        }</script></head><body><div class="main-content clearfix"><div id="sider-wrap" class="catalog"><div class="catalog-header"><h1><a href="https://github.com/loverajoel/jstips">Useful JS Tips</a></h1><select id="J_languages_select"><option value="en">English</option><option value="zh_CN" selected="selected">简体中文</option><option value="zh_TW">繁体中文</option></select></div><ul><li><a href="break-continue-loop-functional" class="" title="58.break 或 continue 循环函数">58.break 或 continue 循环函数</a></li><li><a href="comma-operaton-in-js" class="" title="57.JavaScript 的逗号操作符">57.JavaScript 的逗号操作符</a></li><li><a href="copy-to-clipboard" class="" title="56.复制到粘贴板">56.复制到粘贴板</a></li><li><a href="make-easy-loop-on-array" class="" title="55.用数组建立一个简单的循环">55.用数组建立一个简单的循环</a></li><li><a href="use-optional-arguments" class="" title="54.函数中如何使用可选参数（包括可选回调函数）">54.函数中如何使用可选参数（包括可选回调函数）</a></li><li><a href="get-file-extension" class="" title="53.取得文件扩展名">53.取得文件扩展名</a></li><li><a href="return-values-with-the-new-operator" class="" title="52.new的返回值">52.new的返回值</a></li><li><a href="DOM-event-listening-made-easy" class="" title="51.简单监听DOM事件">51.简单监听DOM事件</a></li><li><a href="helpful-console-log-hacks" class="" title="50.实用的`log`技巧">50.实用的`log`技巧</a></li><li><a href="extract-unix-timestamp-easily" class="" title="49.简单获取unix时间戳">49.简单获取unix时间戳</a></li><li><a href="reminders-about-reduce-function-usage" class="" title="48.怎样`reduce()`数组">48.怎样`reduce()`数组</a></li><li><a href="basics-declarations" class="" title="47.变量声明">47.变量声明</a></li><li><a href="detect-document-ready-in-pure-js" class="" title="46.纯JS监听document是否加载完成">46.纯JS监听document是否加载完成</a></li><li><a href="calculate-the-max-min-value-from-an-array" class="" title="45.计算数组中的最大值/最小值">45.计算数组中的最大值/最小值</a></li><li><a href="know-the-passing-mechanism" class="" title="44.了解传值机制">44.了解传值机制</a></li><li><a href="use-destructuring-in-function-parameters" class="" title="43.函数参数内使用解构">43.函数参数内使用解构</a></li><li><a href="preventing-unapply-attacks" class="" title="42.预防unapply攻击">42.预防unapply攻击</a></li><li><a href="array-average-and-median" class="" title="41.数组平均值与中值">41.数组平均值与中值</a></li><li><a href="using-json-stringify" class="" title="40.使用JSON.Stringify">40.使用JSON.Stringify</a></li><li><a href="advanced-properties" class="" title="39.Javascript高级特性">39.Javascript高级特性</a></li><li><a href="flattening-multidimensional-arrays-in-javascript" class="" title="38.Javascript多维数组扁平化">38.Javascript多维数组扁平化</a></li><li><a href="deduplicate-an-array" class="" title="37.数组去重">37.数组去重</a></li><li><a href="observe-dom-changes" class="" title="36.扩展插件中观察DOM的变化">36.扩展插件中观察DOM的变化</a></li><li><a href="assignment-shorthands" class="" title="35.赋值技巧">35.赋值技巧</a></li><li><a href="implementing-asynchronous-loops" class="" title="34.实现异步循环">34.实现异步循环</a></li><li><a href="create-range-0...n-easily-using-one-line" class="" title="33.仅用一行生成`[0, 1, ..., N-1]`数列">33.仅用一行生成`[0, 1, ..., N-1]`数列</a></li><li><a href="map-to-the-rescue-adding-order-to-object-properties" class="" title="32.Map()的营救；使对象属性有顺序">32.Map()的营救；使对象属性有顺序</a></li><li><a href="avoid-modifying-or-passing-arguments-into-other-functions—it-kills-optimization" class="" title="31.避免修改和传递`arguments`给其他方法 — 影响优化">31.避免修改和传递`arguments`给其他方法 — 影响优化</a></li><li><a href="converting-truthy-falsy-values-to-boolean" class="" title="30.将truthy/falsy转换为布尔值">30.将truthy/falsy转换为布尔值</a></li><li><a href="speed-up-recursive-functions-with-memoization" class="" title="29.运用存储加速递归 Speed up recursive functions with memoization">29.运用存储加速递归 Speed up recursive functions with memoization</a></li><li><a href="curry-vs-partial-application" class="" title="28.柯里化(currying)与部分应用(partial application)">28.柯里化(currying)与部分应用(partial application)</a></li><li><a href="short-circuit-evaluation-in-js" class="" title="27.JS中的短路求值">27.JS中的短路求值</a></li><li><a href="filtering-and-sorting-a-list-of-strings" class="" title="26.过滤并排序字符串列表">26.过滤并排序字符串列表</a></li><li><a href="Using-immediately-invoked-function-expression" class="" title="25.使用立即执行函数表达式">25.使用立即执行函数表达式</a></li><li><a href="use_===_instead_of_==" class="" title="24.使用 === 而不是 ==">24.使用 === 而不是 ==</a></li><li><a href="converting-to-number-fast-way" class="" title="23.转换为数字的更快方法">23.转换为数字的更快方法</a></li><li><a href="two-ways-to-empty-an-array" class="" title="22.清空数组的两种方法">22.清空数组的两种方法</a></li><li><a href="shuffle-an-array" class="" title="21.对数组洗牌">21.对数组洗牌</a></li><li><a href="return-objects-to-enable-chaining-of-functions" class="" title="20.返回对象，使方法可以链式调用">20.返回对象，使方法可以链式调用</a></li><li><a href="safe-string-concatenation" class="" title="19.安全的字符串拼接">19.安全的字符串拼接</a></li><li><a href="rounding-the-fast-way" class="" title="18.快速（但危险）的取整方法">18.快速（但危险）的取整方法</a></li><li><a href="nodejs-run-a-module-if-it-is-not-required" class="" title="17.Node.js - 运行未被引用的模块">17.Node.js - 运行未被引用的模块</a></li><li><a href="passing-arguments-to-callback-functions" class="" title="16.向回调方法传递参数">16.向回调方法传递参数</a></li><li><a href="even-simpler-way-of-using-indexof-as-a-contains-clause" class="" title="15.更简单的使用indexOf实现contains功能">15.更简单的使用indexOf实现contains功能</a></li><li><a href="fat-arrow-functions" class="cur" title="14.箭头函数">14.箭头函数</a></li><li><a href="tip-to-measure-performance-of-a-javascript-block" class="" title="13.测量javascript代码块性能的小知识">13.测量javascript代码块性能的小知识</a></li><li><a href="pseudomandatory-parameters-in-es6-functions" class="" title="12.ES6中的伪强制参数">12.ES6中的伪强制参数</a></li><li><a href="hoisting" class="" title="11.变量提升">11.变量提升</a></li><li><a href="check-if-a-property-is-in-a-object" class="" title="10.检查某对象是否有某属性">10.检查某对象是否有某属性</a></li><li><a href="template-strings" class="" title="09.模板字符串">09.模板字符串</a></li><li><a href="converting-a-node-list-to-an-array" class="" title="08.将Node List转换为数组(Array)">08.将Node List转换为数组(Array)</a></li><li><a href="use-strict-and-get-lazy" class="" title="07.使用&#34;use strict&#34; 变得懒惰">07.使用&#34;use strict&#34; 变得懒惰</a></li><li><a href="writing-a-single-method-for-arrays-and-a-single-element" class="" title="06.可以接受单参数与数组的方法">06.可以接受单参数与数组的方法</a></li><li><a href="differences-between-undefined-and-null" class="" title="05.undefined与null的区别">05.undefined与null的区别</a></li><li><a href="sorting-strings-with-accented-characters" class="" title="04.排列含音节字母的字符串">04.排列含音节字母的字符串</a></li><li><a href="improve-nested-conditionals" class="" title="03.优化嵌套的条件语句">03.优化嵌套的条件语句</a></li><li><a href="keys-in-children-components-are-important" class="" title="02.子容器的Key是很重要的">02.子容器的Key是很重要的</a></li><li><a href="angularjs-digest-vs-apply" class="" title="01.AngularJs - $digest vs $apply">01.AngularJs - $digest vs $apply</a></li><li><a href="insert-item-inside-an-array" class="" title="00.向数组中插入元素">00.向数组中插入元素</a></li></ul></div><div id="content-wrap"><div id="readme" class="boxed-group clearfix announce instapaper_body md"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h2>#14 - 箭头函数</h2><blockquote><p>2016-01-14 by <a href="https://github.com/pklinger/">@pklinger</a></p></blockquote><p>介绍一个ES6的新特性，箭头函数或许一个让你用更少行写更多代码的方便工具。它的名字(fat arrow functions)来自于它的语法<code>=&gt;</code>是一个比瘦箭头<code>-&gt;</code>要’胖的箭头’（译者注：但是国内貌似不分胖瘦就叫箭头函数）。Some programmers might already know this type of functions from different languages such as Haskell as ‘lambda expressions’ respectively ‘anonymous functions’. It is called anonymous, as these arrow functions do not have a descriptive function name.（译者注：一些其他语言中的箭头函数，避免不准确就不翻译了 欢迎PR）</p><h3>有什么益处呢?</h3><ul><li>语法: 更少的代码行; 不再需要一遍一遍的打<code>function</code>了</li><li>语义: 从上下文中捕获<code>this</code>关键字</li></ul><h3>简单的语法示例</h3><p>观察一下这两个功能完全相同的代码片段。你将很快明白箭头函数做了什么。</p><pre><code class="language-javascript"><span class="hljs-comment">// 箭头函数的一般语法</span>
param =&gt; expression

<span class="hljs-comment">// 也可以用用小括号</span>
<span class="hljs-comment">// 多参数时小括号是必须的</span>
(param1 [, param2]) =&gt; expression


<span class="hljs-comment">// 使用functions</span>
<span class="hljs-keyword">var</span> arr = [<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>];
<span class="hljs-keyword">var</span> arrFunc = arr.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x)</span> </span>{
  <span class="hljs-keyword">return</span> x * x;
});
console.log(arr)

<span class="hljs-comment">// 使用箭头函数</span>
<span class="hljs-keyword">var</span> arr = [<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>];
<span class="hljs-keyword">var</span> arrFunc = arr.map((x) =&gt; x*x);
console.log(arr)
</code></pre><p>正如你所看到的，箭头函数在这种情况下省去了写小括号，function以及return的时间。我建议你总是使用小括号，因为对于像<code>(x,y) =&gt; x+y</code>这样多参数函数，小括号总是需要的。这仅是以防在不同使用场景下忘记小括号的一种方法。但是上面的代码和<code>x =&gt; x*x</code>是一样的。至此仅是语法上的提升，减少了代码行数并提高了可读性。</p><h3>Lexically binding <code>this</code></h3><p>这是另一个使用箭头函数的好原因。这是一个关于<code>this</code>上下文的问题。使用箭头函数，你不需要再担心<code>.bind(this)</code>也不用再设置<code>that = this</code>了，因为箭头函数继承了外围作用域的<code>this</code>值。看一下下面的<a href="https://jsfiddle.net/pklinger/rw94oc11/">示例</a>:</p><pre><code class="language-javascript">
<span class="hljs-comment">// 全局定义 this.i</span>
<span class="hljs-keyword">this</span>.i = <span class="hljs-number">100</span>;

<span class="hljs-keyword">var</span> counterA = <span class="hljs-keyword">new</span> CounterA();
<span class="hljs-keyword">var</span> counterB = <span class="hljs-keyword">new</span> CounterB();
<span class="hljs-keyword">var</span> counterC = <span class="hljs-keyword">new</span> CounterC();
<span class="hljs-keyword">var</span> counterD = <span class="hljs-keyword">new</span> CounterD();

<span class="hljs-comment">// 不好的例子</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CounterA</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// CounterA的`this`实例 (!!调用时忽略了此实例)</span>
  <span class="hljs-keyword">this</span>.i = <span class="hljs-number">0</span>;
  setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// `this` 指向全局(global)对象,而不是CounterA的`this`</span>
    <span class="hljs-comment">// 所以从100开始计数,而不是0 (本地的this.i)</span>
    <span class="hljs-keyword">this</span>.i++;
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"counterA"</span>).innerHTML = <span class="hljs-keyword">this</span>.i;
  }, <span class="hljs-number">500</span>);
}

<span class="hljs-comment">// 手动绑定 that = this</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CounterB</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.i = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
  setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    that.i++;
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"counterB"</span>).innerHTML = that.i;
  }, <span class="hljs-number">500</span>);
}

<span class="hljs-comment">// 使用 .bind(this)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CounterC</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.i = <span class="hljs-number">0</span>;
  setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.i++;
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"counterC"</span>).innerHTML = <span class="hljs-keyword">this</span>.i;
  }.bind(<span class="hljs-keyword">this</span>), <span class="hljs-number">500</span>);
}

<span class="hljs-comment">// 箭头函数</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CounterD</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.i = <span class="hljs-number">0</span>;
  setInterval(() =&gt; {
    <span class="hljs-keyword">this</span>.i++;
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"counterD"</span>).innerHTML = <span class="hljs-keyword">this</span>.i;
  }, <span class="hljs-number">500</span>);
}
</code></pre><p>更多有关箭头函数的内容可以查看<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions">MDN</a>。更多语法选项请看<a href="http://jsrocks.org/2014/10/arrow-functions-and-their-scope/">这里</a>.</p></article></div><a id="goto-catalog" href="catalog.html">&lt;&lt;返回目录</a><!-- 多说分享 start --><div class="ds-share flat" data-thread-key="jstips_14" data-title="箭头函数" data-images="http://jstips.hingsir.com/dist/images/github.jpg" data-content="介绍一个ES6的新特性，箭头函数或许一个让你用更少行写更多代码的方便工具。" data-url="http://jstips.hingsir.com/dist/tips/zh_CN/fat-arrow-functions.html"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li><a class="ds-more" href="javascript:void(0);">分享到：</a></li><li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li><li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li><li><a class="ds-qq" href="javascript:void(0);" data-service="qq">QQ</a></li></ul></div></div><!-- 多说分享 end --><!-- 多说评论框 start --><div class="ds-thread" data-thread-key="jstips_14" data-title="箭头函数" data-url="http://jstips.hingsir.com/dist/tips/zh_CN/fat-arrow-functions.html"></div><!-- 多说评论框 end --><!-- 多说公共JS代码 start (一个网页只需插入一次) --><script type="text/javascript">var duoshuoQuery = {short_name:"hingsir"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();</script><!-- 多说公共JS代码 end --><div class="site-footer"><p class="copyright">Powered by <a href="https://github.com/hingsir">@hingsir</a>, 2016</p></div></div></div><a id="forkme" href="https://github.com/hingsir/jstips-site"><img style="position: absolute; top: 0; right: 0; border: 0;z-index:100" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a><script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?d2663479c9de1b01cbc8485ab8cb623d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();</script></body></html>