<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>jstips - A JS tip per day</title><meta name="keywords" content="jstips,tips,js,javascript,front end"><meta name="description" content="Introduces these short and useful daily JavaScript tips that will allow you to improve your code writing. With less than 2 minutes each day, you will be able to read about performance, conventions, hacks, interview questions and all the items that the future of this awesome language holds for us"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scale=no"><link rel="icon" type="image/x-icon" href="../images/favicon.ico"><link rel="stylesheet" type="text/css" href="../css/all-5fb3e513a0.min.css"></head><body><div class="main-content clearfix"><div id="sider-wrap" class="catalog"><div class="catalog-header"><h1><a href="https://github.com/loverajoel/jstips">A JS tip per day</a></h1></div><ul><li><a href="calculate-the-max-min-value-from-an-array" class="" title="45.Calculate the Max/Min value from an array">45.Calculate the Max/Min value from an array</a></li><li><a href="know-the-passing-mechanism" class="" title="44.Know the passing mechanism">44.Know the passing mechanism</a></li><li><a href="use-destructuring-in-function-parameters" class="" title="43.Use destructuring in function parameters">43.Use destructuring in function parameters</a></li><li><a href="preventing-unapply-attacks" class="" title="42.Preventing Unapply Attacks">42.Preventing Unapply Attacks</a></li><li><a href="array-average-and-median" class="" title="41.Array average and median">41.Array average and median</a></li><li><a href="using-json-stringify" class="" title="40.Using JSON.Stringify">40.Using JSON.Stringify</a></li><li><a href="advanced-properties" class="" title="39.Advanced Javascript Properties">39.Advanced Javascript Properties</a></li><li><a href="flattening-multidimensional-arrays-in-javascript" class="" title="38.Flattening multidimensional Arrays in JavaScript">38.Flattening multidimensional Arrays in JavaScript</a></li><li><a href="deduplicate-an-array" class="" title="37.Deduplicate an Array">37.Deduplicate an Array</a></li><li><a href="observe-dom-changes" class="" title="36.Observe DOM changes in extensions">36.Observe DOM changes in extensions</a></li><li><a href="assignment-shorthands" class="" title="35.Assignment Operators">35.Assignment Operators</a></li><li><a href="implementing-asynchronous-loops" class="" title="34.Implementing asynchronous loop">34.Implementing asynchronous loop</a></li><li><a href="create-range-0...n-easily-using-one-line" class="" title="33.Create Range 0...(N-1) easily using one line">33.Create Range 0...(N-1) easily using one line</a></li><li><a href="map-to-the-rescue-adding-order-to-object-properties" class="" title="32.Map() to the rescue; adding order to Object properties">32.Map() to the rescue; adding order to Object properties</a></li><li><a href="avoid-modifying-or-passing-arguments-into-other-functions—it-kills-optimization" class="" title="31.Avoid modifying or passing `arguments` into other functions — it kills optimization">31.Avoid modifying or passing `arguments` into other functions — it kills optimization</a></li><li><a href="converting-truthy-falsy-values-to-boolean" class="" title="30.Converting truthy/falsy values to boolean">30.Converting truthy/falsy values to boolean</a></li><li><a href="speed-up-recursive-functions-with-memoization" class="cur" title="29.Speed up recursive functions with memoization">29.Speed up recursive functions with memoization</a></li><li><a href="curry-vs-partial-application" class="" title="28.Currying vs partial application">28.Currying vs partial application</a></li><li><a href="short-circiut-evaluation-in-js" class="" title="27.Short circuit evaluation in JS.">27.Short circuit evaluation in JS.</a></li><li><a href="filtering-and-sorting-a-list-of-strings" class="" title="26.Filtering and Sorting a List of Strings">26.Filtering and Sorting a List of Strings</a></li><li><a href="Using-immediately-invoked-function-expression" class="" title="25.Using immediately invoked function expression">25.Using immediately invoked function expression</a></li><li><a href="use_===_instead_of_==" class="" title="24.Use === instead of ==">24.Use === instead of ==</a></li><li><a href="converting-to-number-fast-way" class="" title="23.Converting to number fast way">23.Converting to number fast way</a></li><li><a href="two-ways-to-empty-an-array" class="" title="22.Two ways to empty an array">22.Two ways to empty an array</a></li><li><a href="shuffle-an-array" class="" title="21.Shuffle an Array">21.Shuffle an Array</a></li><li><a href="return-objects-to-enable-chaining-of-functions" class="" title="20.Return objects to enable chaining of functions">20.Return objects to enable chaining of functions</a></li><li><a href="safe-string-concatenation" class="" title="19.Safe string concatenation">19.Safe string concatenation</a></li><li><a href="rounding-the-fast-way" class="" title="18.Rounding the fast way">18.Rounding the fast way</a></li><li><a href="nodejs-run-a-module-if-it-is-not-required" class="" title="17.Node.js - Run a module if it is not `required`">17.Node.js - Run a module if it is not `required`</a></li><li><a href="passing-arguments-to-callback-functions" class="" title="16.Passing arguments to callback functions">16.Passing arguments to callback functions</a></li><li><a href="even-simpler-way-of-using-indexof-as-a-contains-clause" class="" title="15.Even simpler way of using `indexOf` as a contains clause">15.Even simpler way of using `indexOf` as a contains clause</a></li><li><a href="fat-arrow-functions" class="" title="14.Fat Arrow Functions">14.Fat Arrow Functions</a></li><li><a href="tip-to-measure-performance-of-a-javascript-block" class="" title="13.Tip to measure performance of a javascript block">13.Tip to measure performance of a javascript block</a></li><li><a href="pseudomandatory-parameters-in-es6-functions" class="" title="12.Pseudomandatory parameters in ES6 functions">12.Pseudomandatory parameters in ES6 functions</a></li><li><a href="hoisting" class="" title="11.Hoisting">11.Hoisting</a></li><li><a href="check-if-a-property-is-in-a-object" class="" title="10.Check if a property is in a Object">10.Check if a property is in a Object</a></li><li><a href="template-strings" class="" title="09.Template Strings">09.Template Strings</a></li><li><a href="converting-a-node-list-to-an-array" class="" title="08.Converting a Node List to an Array">08.Converting a Node List to an Array</a></li><li><a href="use-strict-and-get-lazy" class="" title="07.use strict and get lazy">07.use strict and get lazy</a></li><li><a href="writing-a-single-method-for-arrays-and-a-single-element" class="" title="06.Writing a single method for arrays and a single element">06.Writing a single method for arrays and a single element</a></li><li><a href="differences-between-undefined-and-null" class="" title="05.Differences between `undefined` and `null`">05.Differences between `undefined` and `null`</a></li><li><a href="sorting-strings-with-accented-characters" class="" title="04.Sorting strings with accented characters">04.Sorting strings with accented characters</a></li><li><a href="improve-nested-conditionals" class="" title="03.Improve Nested Conditionals">03.Improve Nested Conditionals</a></li><li><a href="keys-in-children-components-are-important" class="" title="02.Keys in children components are important">02.Keys in children components are important</a></li><li><a href="angularjs-digest-vs-apply" class="" title="01.AngularJs - `$digest` vs `$apply`">01.AngularJs - `$digest` vs `$apply`</a></li><li><a href="insert-item-inside-an-array" class="" title="00.Insert item inside an Array">00.Insert item inside an Array</a></li></ul></div><div id="content-wrap"><div id="readme" class="boxed-group clearfix announce instapaper_body md"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h2 id="-29-speed-up-recursive-functions-with-memoization">#29 - Speed up recursive functions with memoization</h2><blockquote><p>2016-01-29 by <a href="https://github.com/hingsir">@hingsir</a></p></blockquote><p>Fibonacci sequence is very familiar to everybody. we can write the following function in 20 seconds.</p><pre><code class="lang-js"><span class="hljs-keyword">var</span> fibonacci = function(<span class="hljs-keyword">n</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">n</span> &lt; 2 ? <span class="hljs-keyword">n</span> : fibonacci(<span class="hljs-keyword">n</span>-1) + fibonacci(<span class="hljs-keyword">n</span>-2);
}
</code></pre><p>it works, but not efficient. it did lots of duplicate computing works, we can cache its previously computed results to speed it up.</p><pre><code class="lang-js">var fibonacci = (<span class="hljs-name">function</span>(){
    var cache = {
        <span class="hljs-number">0</span>: <span class="hljs-number">0</span>,
        <span class="hljs-number">1</span>: <span class="hljs-number">1</span>
    }<span class="hljs-comment">;</span>
    return function self(<span class="hljs-name">n</span>){
        return n in cache ? cache[n] : (<span class="hljs-name">cache</span>[n] = self(<span class="hljs-name">n-1</span>) + self(<span class="hljs-name">n-2</span>))<span class="hljs-comment">;</span>
    }
})()
</code></pre><p>Also, we can define a higher-order function that accepts a function as its argument and returns a memoized version of the function.</p><pre><code class="lang-js"><span class="hljs-keyword">var</span> memoize = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func</span>)</span>{
    <span class="hljs-keyword">var</span> cache = {};
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> key = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>).toString();
        <span class="hljs-keyword">return</span> key <span class="hljs-keyword">in</span> cache ? cache[key] : (cache[key] = func.apply(<span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>));
    }
}
fibonacci = memoize(fibonacci);
</code></pre><p>And there is a ES6 version of the memoize function.</p><pre><code class="lang-js">var memoize = function(<span class="hljs-function"><span class="hljs-keyword">func</span>){</span>
    <span class="hljs-keyword">const</span> cache = {}<span class="hljs-comment">;</span>
    <span class="hljs-keyword">return</span> (...args) =&gt; {
        <span class="hljs-keyword">const</span> key = [...args].toString()<span class="hljs-comment">;</span>
        <span class="hljs-keyword">return</span> key <span class="hljs-keyword">in</span> cache ? cache[key] : (cache[key] = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(...args)</span>);</span>
    }
}
fibonacci = memoize(fibonacci)<span class="hljs-comment">;</span>
</code></pre><p>we can use <code>memoize()</code> in many other situations</p><ul><li>GCD(Greatest Common Divisor)</li></ul><pre><code class="lang-js">var gcd = memoize(function(a,<span class="hljs-keyword">b){
</span>    var t<span class="hljs-comment">;</span>
    if (a &lt; <span class="hljs-keyword">b) </span>t=<span class="hljs-keyword">b, </span><span class="hljs-keyword">b=a, </span>a=t<span class="hljs-comment">;</span>
    while(<span class="hljs-keyword">b </span>!= <span class="hljs-number">0</span>) t=<span class="hljs-keyword">b, </span><span class="hljs-keyword">b </span>= a%<span class="hljs-keyword">b, </span>a=t<span class="hljs-comment">;</span>
    return a<span class="hljs-comment">;</span>
})
gcd(<span class="hljs-number">27</span>,<span class="hljs-number">183</span>)<span class="hljs-comment">; //=&gt; 3</span>
</code></pre><ul><li>Factorial calculation</li></ul><pre><code class="lang-js"><span class="hljs-keyword">var</span> factorial = memoize(function(<span class="hljs-keyword">n</span>) {
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">n</span> &lt;= 1) ? 1 : <span class="hljs-keyword">n</span> * factorial(<span class="hljs-keyword">n</span>-1);
})
factorial(5); <span class="hljs-comment">//=&gt; 120</span>
</code></pre></article></div><a id="goto-catalog" href="catalog.html">&lt;&lt;返回目录</a><!-- 多说分享 start --><div class="ds-share flat" data-thread-key="jstips_29" data-title="Speed up recursive functions with memoization" data-images="http://jstips.hingsir.com/dist/images/github.jpg" data-content="Fibonacci sequence is very familiar to everybody. we can write the following function in 20 seconds.it works, but not efficient. it did lots of duplicate computing works, we can cache its previously computed results to speed it up." data-url="http://jstips.hingsir.com/dist/tips/speed-up-recursive-functions-with-memoization.html"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li><a class="ds-more" href="javascript:void(0);">分享到：</a></li><li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li><li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><!-- 多说分享 end --><!-- 多说评论框 start --><div class="ds-thread" data-thread-key="jstips_29" data-title="Speed up recursive functions with memoization" data-url="http://jstips.hingsir.com/dist/tips/speed-up-recursive-functions-with-memoization.html"></div><!-- 多说评论框 end --><!-- 多说公共JS代码 start (一个网页只需插入一次) --><script type="text/javascript">var duoshuoQuery = {short_name:"hingsir"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();</script><!-- 多说公共JS代码 end --><div class="site-footer"><p class="copyright">Powered by <a href="https://github.com/hingsir">@hingsir</a>, 2016</p></div></div></div><a id="forkme" href="https://github.com/hingsir/jstips-site"><img style="position: absolute; top: 0; right: 0; border: 0;z-index:100" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a></body></html>